import{Ia as k,Ta as E,Ua as P,Va as T,Wa as B,Xa as L,Xb as F,Yb as y,Z as w,bb as R,c as S,d as X,fa as M,z as C}from"./chunk-MFWHCUK5.js";var n=S(X());var a=S(C()),h=(e,s)=>{let r=e.text||e.value;return r===""&&s?s:r},W=(e,s)=>e?(e=e.toLowerCase(),s.map(r=>{let c=h(r).toLowerCase(),i=0;return c===e?i=3:c.startsWith(e)?i=2:c.includes(e)&&(i=1),{item:r,score:i}}).filter(r=>r.score>0).sort((r,l)=>l.score-r.score).map(r=>r.item)):s,Z=e=>{let[s,r]=(0,n.useState)(""),[l,c]=(0,n.useState)(e.selectedOption??{value:""}),i=e.id??(0,n.useId)(),$=`${i}-listbox`,[u,H]=(0,n.useState)(0),d=(0,n.useRef)(null),f=(0,n.useRef)(null),[x,p]=(0,n.useState)(!1),O=(0,n.useRef)(null),m=(0,n.useRef)({}),[K,g]=(0,n.useState)(!1),[D,z]=(0,n.useState)(-1),[N,I]=(0,n.useState)(!1),v=t=>{let o=e.options.findIndex(b=>b.value===t.value);c(t),z(o),e.onSelect(t,o),p(!1),g(!1)},V=t=>{if(t.key==="Enter"){if(!s)return;let o=W(s,e.options);o.length>0&&(v(o[0]),t.stopPropagation(),t.preventDefault())}else t.key==="Escape"&&p(!1)},_=(t,o)=>{r(o.value||"")},q=()=>W(s,e.options).map(t=>(0,a.jsx)(P,{ref:o=>{o&&(m.current[t.value]=o)},onClick:()=>{v(t)},style:{width:`${u-10}px`,maxWidth:`${u-10}px`,padding:"5px 0px",margin:"2px"},name:"dropdown-options",value:t.value,onFocus:()=>{N&&(m.current[l.value]&&setTimeout(()=>{m.current[l.value]?.focus()},0),I(!1))},children:h(t)},`${i}-${t.value}`)),A=()=>e.clearable?D===-1?(0,a.jsx)(w,{}):(0,a.jsx)(M,{style:{cursor:"pointer"},onClick:t=>{v({value:""}),t.stopPropagation(),d.current?.focus()},onKeyDown:t=>{t.key==="Enter"&&(v({value:""}),t.stopPropagation(),d.current?.focus())},"aria-label":y.common.clearSelection,title:y.common.clearSelection,role:"button",tabIndex:0}):(0,a.jsx)(w,{});return(0,n.useEffect)(()=>{d.current&&H(Math.max(d.current.offsetWidth-10,200))},[d.current]),(0,n.useEffect)(()=>{c(e.selectedOption??e.options[0])},[e.selectedOption]),(0,a.jsxs)(E,{positioning:{autoSize:!0},onOpenChange:async(t,o)=>{r(""),f.current&&f.current.focus(),p(o.open),D!==-1&&!K&&requestAnimationFrame(()=>{let b=m.current[l.value];b&&O.current&&b.scrollIntoView({block:"nearest",behavior:"instant"}),g(!0)}),o.open||g(!1)},open:x,hasCheckmarks:!0,checkedValues:{"dropdown-options":[l.value]},"aria-label":e.ariaLabel||"options",children:[(0,a.jsx)(L,{disableButtonEnhancement:!0,children:(0,a.jsx)(k,{id:i,size:e.size??"medium",ref:d,icon:A(),iconPosition:"after",role:"combobox","aria-haspopup":"listbox","aria-expanded":x,"aria-label":e.ariaLabel,disabled:e.disabled,className:x?"dropdown-open":"",style:{...e.style,justifyContent:"space-between",fontWeight:400},children:(0,a.jsx)(R,{style:{overflow:"hidden",textOverflow:"ellipsis"},className:h(l,e.placeholder)===e.placeholder?"placeholder":"",title:h(l,e.placeholder),children:h(l,e.placeholder)})})}),(0,a.jsx)(B,{style:{width:u},children:(0,a.jsxs)(T,{children:[(0,a.jsx)(F,{ref:f,placeholder:e.searchBoxPlaceholder,value:s,onChange:(t,o)=>_(t,o),"aria-controls":$,onKeyDown:t=>V(t),style:{width:u,maxWidth:u},onFocus:()=>{I(!0)}}),(0,a.jsx)("div",{style:{maxHeight:"200px",overflowY:"auto",width:`${u}px`,overflowX:"hidden"},role:"presentation",ref:O,onKeyDown:t=>{t.key==="Escape"&&(p(!1),g(!1)),f.current&&(t.key.length===1||t.key==="Backspace")&&(f.current?.focus(),f.current.value=t.key)},children:q()})]})})]})};export{Z as a};
